# EDA

## Univariate Analysis

Examine each variable individually to understand its distribution, central tendency, and spread.

```{python}
# Code visibility controlled by format settings in report.qmd
import pandas as pd
import numpy as np
import warnings
import matplotlib.pyplot as plt
import seaborn as sns
import plotly as py
import plotly.graph_objs as go
import statistics

url = "https://data.nsw.gov.au/data/dataset/4ff1a0de-9bff-4b45-9f93-5a9bf44df257/resource/5b843384-5aea-4bc4-9935-0dd91ea2559d/download/2020_rws-updated.csv"
df = pd.read_csv(url, encoding="ISO-8859-1")
# delete all the duplicated rows
df[df.duplicated(keep=False)]

# delete all the columns with think are not significant to lower the size of the dataset for better readibility
cols_to_drop = [0,4, 6, 11, 14, 15, 16, 18, 22, 23, 24, 26, 28, 29, 30, 31] + list(range(41, 73))
df = df.drop(df.columns[cols_to_drop], axis=1)

# Rename column
rename_map = {
    "Response ID": "Response_ID",
    "What year were you born?": "Age",
    "What is your gender?": "Gender",
    "Which of the following best describes your industry?": "Industry",
    "Which of the following best describes your current occupation?": "Job_type",
    "How many people are currently employed by your organisation?": "Organisation_Size",
    "Do you manage people as part of your current occupation?": "Managing_position",
    "Which of the following best describes your household?": "Household",
    "How long have you been in your current job?": "Years_in_job",
    "Thinking about your current job, how much of your time did you spend remote working last year?": "Remote_pct_last_year",
    "Thinking about remote working last year, how strongly do you agree or disagree with the following statements? - My organisation encouraged people to work remotely": "Org_encouraged_remote_last_year",
    "Thinking about remote working last year, how strongly do you agree or disagree with the following statements? - I could easily collaborate with colleagues when working remotely": "Collaboration_remote_last_year",
    "How much of your time would you have preferred to work remotely last year?": "Preferred_remote_last_year",
    "Thinking about your current job, how much of your time did you spend remote working in the last 3 months?": "Remote_pct_last_3_months",
    "Thinking about remote working in the last 3 months, how strongly do you agree or disagree with the following statements? - My organisation encouraged people to work remotely": "Org_encouraged_remote_3_months",
    "Thinking about remote working in the last 3 months, how strongly do you agree or disagree with the following statements? - I could easily collaborate with colleagues when working remotely": "Collaboration_remote_3_months",
    "How much of your time would you have preferred to work remotely in the last 3 months?": "Preferred_remote_3_months",
    "This question is about your productivity. Productivity means what you produce for each hour that you work. It includes the amount of work you achieve each hour, and the quality of your work each hour.  \nPlease compare your productivity when you work remotely to when you work at your employer\x92s workplace.  \nRoughly how productive are you, each hour, when you work remotely?": "Productivity_remote_vs_workplace",
    "On a day when you attend your employer's workplace, how many hours would you spend doing the following activities? - Preparing for work and commuting": "Commute_hours_workplace",
    "On a day when you attend your employer's workplace, how many hours would you spend doing the following activities? - Working": "Working_hours_workplace",
    "On a day when you attend your employer's workplace, how many hours would you spend doing the following activities? - Personal and family time": "Personal_family_hours_workplace",
    "On a day when you attend your employer's workplace, how many hours would you spend doing the following activities? - Caring and domestic responsibilities": "Domestic_hours_workplace",
    "On a day when you do remote work, how many hours would you spend doing the following activities? - Preparing for work and commuting": "Commute_hours_remote",
    "On a day when you do remote work, how many hours would you spend doing the following activities? - Working": "Working_hours_remote",
    "On a day when you do remote work, how many hours would you spend doing the following activities? - Personal and family time": "Personal_family_hours_remote",
    "On a day when you do remote work, how many hours would you spend doing the following activities? - Caring and domestic responsibilities": "Domestic_hours_remote"}
df.rename(columns=rename_map, inplace=True)

# 1. Organisation Size
df["Organisation_Size"] = df["Organisation_Size"].replace({
    "I am the only employee": "Solo business",
    "Between 1 and 4": "Micro enterprise",
    "Between 5 and 19": "Small enterprise",
    "Between 20 and 199": "Medium enterprise",
    "More than 200": "Large / Corporate enterprise"}).fillna("Other / Unspecified")

# 2. Gender & Managing Position
df = df[df["Gender"] != "Rather not say"]
df["Gender"] = df["Gender"].replace({"Male": 0, "Female": 1}).astype("category")
df["Managing_position"] = df["Managing_position"].replace({"No": 0, "Yes": 1}).astype("category")
df = df.dropna(subset=["Managing_position"])

# 3. Age (convert birth year to age in 2020)
df["Age"] = 2020 - df["Age"]

# 4. Years in job
df["Years_in_job"] = df["Years_in_job"].replace({
    "More than 5 years": "5+",
    "Between 1 and 5 years": "5-",
    "Between 6 and 12 months": "1-"})

# 5. Likert scale mapping
likert_mapping = {
    "Strongly disagree": 1,
    "Somewhat disagree": 2,
    "Neither agree nor disagree": 3,
    "Somewhat agree": 4,
    "Strongly agree": 5}
likert_cols = [
    "Org_encouraged_remote_last_year",
    "Collaboration_remote_last_year",
    "Org_encouraged_remote_3_months",
    "Collaboration_remote_3_months"]
df[likert_cols] = df[likert_cols].replace(likert_mapping).fillna(3)

# 6. Remote percentages mapping
remote_mapping = {
    "Rarely or never": 0,
    "Less than 10% of my time": 5,
    "10%": 10,
    "20%": 20,
    "30%": 30,
    "40%": 40,
    "50% - About half of my time": 50,
    "50% - I spent about half of my time remote working": 50,
    "60%": 60,
    "70%": 70,
    "80%": 80,
    "90%": 90,
    "100% - All of my time": 100,
    "100% - I spent all of my time remote working": 100,
    "I would not have preferred to work remotely": 0}
percent_cols = [
    "Preferred_remote_last_year",
    "Remote_pct_last_year",
    "Remote_pct_last_3_months",
    "Preferred_remote_3_months"]
for col in percent_cols:
    df[col] = df[col].astype(str).str.replace("\xa0", "", regex=True).str.strip().replace(remote_mapping)
    df[col] = pd.to_numeric(df[col], errors="coerce") / 100  # Convert to proportion

# 7. Productivity cleaning
def parse_productivity(val):
    if pd.isna(val):
        return None
    val = str(val).replace("\x92", "'")  # Fix apostrophe
    if "more productive" in val:
        return int(val.split("%")[0].replace("I'm ", "").strip())
    elif "less productive" in val:
        return -int(val.split("%")[0].replace("I'm ", "").strip())
    elif "same" in val:
        return 0
    return None
df["Productivity_remote_vs_workplace"] = df["Productivity_remote_vs_workplace"].apply(parse_productivity)
```

From this code we got the full results of all our variables in terms of distribution sorted by occurrence. The relevant information we gathered from these are the followings:

```{python}
# Code visibility controlled by format settings in report.qmd

for col in df.columns:
    print("\n--- Age ---")
    print(df["Age"].value_counts(dropna=False))
```

-   Age: we have some outliers for the age variable with 2 people 120 years old that needs to be treated

```{python}
# Code visibility controlled by format settings in report.qmd

for col in df.columns:
    print("\n--- Gender ---")
    print(df["Gender"].value_counts(dropna=False))
```

-   Gender: good balance (604 / (604+766) = 44% of women)

```{python}
# Code visibility controlled by format settings in report.qmd

for col in df.columns:
    print("\n--- Years_in_job ---")
    print(df["Years_in_job"].value_counts(dropna=False))
```

-   Years in job: sample is quite experienced with only 11% with less than 1 year of experience.

```{python}
# Code visibility controlled by format settings in report.qmd

for col in df.columns:
    print("\n--- Productivity_remote_vs_workplace ---")
    print(df["Productivity_remote_vs_workplace"].value_counts(dropna=False))
```

- Productivity remote vs workplace: we can see that for most of them productivity is either equivalent, or they even gained in productivity (46% gained between 20 to 50% of productivity).

## Distribution Plot

Concretely, if we look at the distribution of the change in productivity with this code :  

```{python}
# Code visibility controlled by format settings in report.qmd
# Violin Plot: Productivity by Organisation Size 
plt.figure(figsize=(8,4)) 
sns.violinplot(x=df['Organisation_Size'], y=df['Productivity_remote_vs_workplace']) 
plt.title('Productivity Change by Organisation Size') 
plt.xlabel('Organisation Size') 
plt.ylabel('Productivity Change (%)') 
plt.show() 

```

In this Violin plot, we can understand that the change in productivity is not really influenced by the size of the company. Nevertheless, we can observe for small enterprises that a negative change in productivity is even rarer. We can guess that people in small businesses don’t depend too much on working with peers and with teams, so going to the workplace is less necessary than in big companies and communications facilitated. 



## Bivariate Analysis

Explore relationships between two variables.

Our univariate analysis in @fig-performance-dist revealed that performance scores follow an approximately normal distribution with a mean of 0.90. The box plot (@fig-performance-box) confirmed this finding and helped identify a few outliers at the lower end of the distribution.

::: callout-tip
## How to Reference Figures

Use `@fig-label` syntax to reference figures in your text. Quarto automatically numbers them and creates clickable links.

**Examples with figures in this template:**

-   `@fig-performance-dist` → See @fig-performance-dist for details
-   `@fig-correlation-matrix` → As shown in @fig-correlation-matrix
-   `@tbl-anova-test` → The ANOVA results in @tbl-anova-test

**Why reference figures?**

1.  Automatic numbering (updates if you reorder)
2.  Clickable links in HTML output
3.  Professional academic writing standard
4.  Helps readers find the relevant visualization

**Example usage in text:**

"The distribution shown in @fig-performance-dist indicates..."

"As seen in @fig-correlation-matrix, there is a strong positive correlation..."
:::

Now let's examine how performance varies across different instructors.

::: panel-tabset
## Grouped Comparison

```{python}
#| label: fig-performance-by-instructor
#| fig-cap: "Performance scores grouped by instructor showing variation across instructors"
# Code visibility controlled by format settings in report.qmd

fig, ax = plt.subplots(figsize=(8, 5))

```

## Statistical Test

```{python}
#| label: tbl-anova-test
#| tbl-cap: "ANOVA test results for performance differences across instructors"
# Code visibility controlled by format settings in report.qmd

```

## Scatter Plot

```{python}
#| label: fig-scatter-experience-performance
#| fig-cap: "Scatter plot showing positive relationship between experience and performance"
# Code visibility controlled by format settings in report.qmd

```
:::

## Key Findings